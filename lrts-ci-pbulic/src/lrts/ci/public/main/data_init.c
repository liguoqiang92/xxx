/**
 * @file data_init.c
 * @brief
 * @author dingjian
 * @date 2016-09-24
 *
 * $Id$
 */

/**
===Change Log of module===

 v0.1.0 dingjian

=====End of change log====
*/

#include "ci_public_comm.h"

track_t g_track[TRACK_NUM]={
    /*
    区段ID,区段名称，区段状态机，状态，锁闭，封锁，道岔ID，保护区段，区段限速，上行指针，下行指针
    3001,   "TO401",   0,      2,    2 ,    2,   0,    0,     0,      0,   0
    */
    {0x01000001,"T0401",0,2,2,2,0,0,0,0,0,0},
    {0x01000002,"T0402",0,2,2,2,0,0,0,0,0,0},
    {0x01000003,"T0403",0,2,2,2,0,0,0,0,0,0},
    {0x01000004,"T0404",0,2,2,2,0,0,0,0,0,0},
    {0x01000005,"T0405",0,2,2,2,0,0,0,0,0,0},
    {0x01000006,"T0406",0,2,2,2,0,0,0,0,0,0},
    {0x01000007,"T0407",0,2,2,2,0,0,0,0,0,0},
    {0x01000008,"PT0408",0,2,2,2,0,0,0,0,0,0},
    {0x01000009,"T0409",0,2,2,2,0,0,0,0,0,0},
    {0x0100000A,"T0411",0,2,2,2,0,0,0,0,0,0},
    {0x0100000B,"T0412",0,2,2,2,0,0,0,0,0,0},
    {0x0100000C,"T0413",0,2,2,2,0,0,0,0,0,0},
    {0x0100000D,"T0414",0,2,2,2,0,0,0,0,0,0},
    {0x0100000E,"T0415",0,2,2,2,0,0,0,0,0,0},
    {0x0100000F,"T0416",0,2,2,2,0,0,0,0,0,0},
    {0x01000010,"T0417",0,2,2,2,0,0,0,0,0,0},
    {0x01000011,"T0418",0,2,2,2,0,0,0,0,0,0},
    {0x01000012,"T0419",0,2,2,2,0,0,0,0,0,0},
    {0x01000013,"T0420",0,2,2,2,0,0,0,0,0,0},
    {0x01000014,"T0421",0,2,2,2,0,0,0,0,0,0},
    {0x01000015,"T0422",0,2,2,2,0,0,0,0,0,0},
    {0x01000016,"T0423",0,2,2,2,0,0,0,0,0,0},
    {0x01000017,"T0424",0,2,2,2,0,0,0,0,0,0},
    {0x01000018,"T0425",0,2,2,2,0,0,0,0,0,0},
    {0x01000019,"T0426",0,2,2,2,0,0,0,0,0,0},
    {0x0100001A,"PT0427",0,2,2,2,0,0,0,0,0,0},
    {0x0100001B,"T0428",0,2,2,2,0,0,0,0,0,0},
    {0x0100001C,"T0429",0,2,2,2,0,0,0,0,0,0},
    {0x0100001D,"PT0430",0,2,2,2,0,0,0,0,0,0},
    {0x0100001E,"PT0432",0,2,2,2,0,0,0,0,0,0},
    {0x0100001F,"T0434",0,2,2,2,0,0,0,0,0,0},
    {0x01000020,"P0604",0,2,2,2,0,0,0,0,0,0},

};

r_t_list_t r_r0={
    1,0x0100001E
};

r_t_list_t r_rd0702={
    2,0x01000020,0x0100001C
};

r_t_list_t r_rd0603={
    2,0x0100001A,0x01000018
};

r_t_list_t r_rd0601={
    3,0x01000016,0x01000014,0x01000012
};

r_t_list_t r_rd0501={
    3,0x01000010,0x0100000E,0x0100000C
};

r_t_list_t r_rd0401={
    2,0x0100000A,0x01000009
};

r_t_list_t r_rd0301={
    2,0x01000007,0x01000005
};

r_t_list_t r_rd0201={
    3,0x01000003,0x01000001,0x01000002
};

r_t_list_t r_ru0102={
    2,0x01000004,0x01000006
};

r_t_list_t r_ru0202={
    3,0x01000008,0x0100000B,0x0100000D
};

r_t_list_t r_ru0304={
    2,0x0100000F,0x01000011
};

r_t_list_t r_ru0404={
    2,0x01000013,0x01000015
};

r_t_list_t r_ru0502={
    3,0x01000017,0x01000019,0x0100001B
};

r_t_list_t r_ru0602={
    3,0x0100001D,0x0100001E,0x0100001F
};

signal_t g_signal[SIGNAL_NUM]={
  {0x03000001,"U0704",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x03000002,"D0702",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x03000003,"D0603",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x03000004,"D0601",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x03000005,"D0501",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x03000006,"D0401",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x03000007,"D0301",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x03000008,"D0201",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x03000009,"U0102",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x0300000A,"U0202",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x0300000B,"U0304",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x0300000C,"U0404",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x0300000D,"U0502",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0},
  {0x0300000E,"U0602",0,2,2,2,2,1,1,1,1,1,2,2,0,0,0,0}
};

route_t g_route[ROUTE_NUM]={
    /*
    进路ID，进路名称，进路状态机，预先锁闭，接近锁闭，多车，进路类型，方向1，方向2，始端信号机ID，终端信号机ID，道岔列表，敌对列表，区段列表，其他对象，接近区段列表，延时解锁时间，自动触发区段列表1，自动触发区段列表2，保护区段，保护区段延时解锁区段，保护区段延时解锁时间，保护区段立即解锁，上行，下行
    1001    r0        0           0         0       0     0         0      0   2001          2002          0      0     {tra**t_id}  0																																	1
    */
    {0x02000001,"r0",0,0,0,0,0,0,0,0,0x03000001,0x03000002,8600,0,0,&r_r0,0,0,0,0,0,0x01000020,0,0,1,0,0},
    {0x02000002,"rD0702",0,0,0,0,0,0,0,0,0x03000002,0x03000003,20000,0,0,&r_rd0702,0,0,0,0,0,0x0100001A,0,0,1,0,0},
    {0x02000003,"rD0603",0,0,0,0,0,0,0,0,0x03000003,0x03000004,18600,0,0,&r_rd0603,0,0,0,0,0,0x01000016,0,0,1,0,0},
    {0x02000004,"rD0601",0,0,0,0,0,0,0,0,0x03000004,0x03000005,113298,0,0,&r_rd0601,0,0,0,0,0,0x01000010,0,0,1,0,0},
    {0x02000005,"rD0501",0,0,0,0,0,0,0,0,0x03000005,0x03000006,62670,0,0,&r_rd0501,0,0,0,0,0,0x0100000A,0,0,1,0,0},
    {0x02000006,"rD0401",0,0,0,0,0,0,0,0,0x03000006,0x03000007,61330,0,0,&r_rd0401,0,0,0,0,0,0x01000007,0,0,1,0,0},
    {0x02000007,"rD0301",0,0,0,0,0,0,0,0,0x03000007,0x03000008,68000,0,0,&r_rd0301,0,0,0,0,0,0x01000003,0,0,1,0,0},
    {0x02000008,"rD0201",0,0,0,0,0,0,0,0,0x03000008,0x03000009,66800,0,0,&r_rd0201,0,0,0,0,0,0x01000004,0,0,1,0,0},
    {0x02000009,"rU0102",0,0,0,0,0,0,0,0,0x03000009,0x0300000A,58200,0,0,&r_ru0102,0,0,0,0,0,0x01000008,0,0,1,0,0},
    {0x0200000A,"rU0202",0,0,0,0,0,0,0,0,0x0300000A,0x0300000B,109000,0,0,&r_ru0202,0,0,0,0,0,0x0100000F,0,0,1,0,0},
    {0x0200000B,"rU0304",0,0,0,0,0,0,0,0,0x0300000B,0x0300000C,62040,0,0,&r_ru0304,0,0,0,0,0,0x01000013,0,0,1,0,0},
    {0x0200000C,"rU0404",0,0,0,0,0,0,0,0,0x0300000C,0x0300000D,62530,0,0,&r_ru0404,0,0,0,0,0,0x01000017,0,0,1,0,0},
    {0x0200000D,"rU0502",0,0,0,0,0,0,0,0,0x0300000D,0x0300000E,113298,0,0,&r_ru0502,0,0,0,0,0,0x0100001D,0,0,1,0,0},
    {0x0200000E,"rU0602",0,0,0,0,0,0,0,0,0x0300000E,0x03000001,39500,0,0,&r_ru0602,0,0,0,0,0,0x0100001E,0,0,1,0,0}
};

balise_t g_balise[BALISE_NUM]={

    {0x0400003F,"DB0603A",0x0100001C,0,0,0x03000003,0,0},
    {0x0400003B,"DB0601",0x01000018,0,0,0x03000004,0,0},
    {0x0400002D,"DB0501",0x01000012,0,0,0x03000005,0,0},
    {0x04000021,"DB0401",0x0100000C,0,0,0x03000006,0,0},
    {0x04000015,"DB0301",0x01000009,0,0,0x03000007,0,0},
    {0x04000009,"DB0201",0x01000005,0,0,0x03000008,0,0},
    {0x04000003,"DB0102",0x01000002,0,0,0x03000009,0,0},
    {0x0400000B,"DB0202",0x01000006,0,0,0x0300000A,0,0},
    {0x04000019,"DB0304",0x0100000D,0,0,0x0300000B,0,0},
    {0x04000025,"DB0404",0x01000011,0,0,0x0300000C,0,0},
    {0x0400002F,"DB0502",0x01000015,0,0,0x0300000D,0,0},
    {0x0400003D,"DB0602",0x0100001B,0,0,0x0300000E,0,0}

};



int16_t data_init()
{
    uint8_t i,m;
    route_t *p;


	printp("\n");
    printp("区段列表\n");
    for(m = 0;m<TRACK_NUM;m++){
        printp("%u  %s  %u  %u  %u  %u  %u  %u  %u  %u  %u\n",&g_track[m].t_id,g_track[m].t_name,g_track[m].t_fsm,g_track[m].t_status,g_track[m].t_lock,
            g_track[m].t_blockade,g_track[m].t_w_id,g_track[m].t_feature,g_track[m].t_speed,g_track[m].t_up_next,g_track[m].t_down_next);
    }

    printp("信号机列表\n");
    for(i=0;i<14;i++){
        if (g_route[i].r_id==1003){
            for (m = 0; m< 15; m++){
                if(g_signal[m].s_id == g_route[i].r_s_start_id){
                    printp("%u  %s\n",g_signal[m].s_id,g_signal[m].s_name);
                }
            }
        }
    }

    printp("进路的列表\n");
    for(i=0;i<14;i++){
        /*len = 0;
        while(g_route[i].r_t_list[len]!='\0')
        {
        len++;
        }*/

        g_route[i].r_singletrain = 1;

        printp("%u  %s  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u\n",g_route[i].r_id,g_route[i].r_name,g_route[i].r_fsm,g_route[i].r_singletrain,g_route[i].r_triggertype,g_route[i].r_direction_1,g_route[i].r_direction_2,
            g_route[i].r_s_start_id,g_route[i].r_s_end_id,g_route[i].r_w_list,g_route[i].r_s_anti_list,g_route[i].r_t_list,g_route[i].r_other_list,g_route[i].r_t_proach_list,g_route[i].r_t_proach_dealy,
            g_route[i].r_t_auto_list_1,g_route[i].r_t_auto_list_2,g_route[i].r_t_protect,g_route[i].r_t_protect_track,g_route[i].r_t_protect_dealy,g_route[i].r_t_protect_unlock,g_route[i].r_up_next,g_route[i].r_down_next);
    }
    printp("track的指针访问\n");
    printp("%u %u  %u\n",r_r0.num,r_r0.id1,r_r0.id2);
    printp("%u\n",&r_rd0702+1);
    printp("%u %u  %u\n",r_rd0603.num,r_rd0603.id1,r_rd0603.id2);


    p = g_route;
    printp("进路的指针访问\n");
    for(p = g_route;p<g_route + 14;p++){
        if ((*p).r_id == 1002){
            p->r_singletrain = 0;
            printp("%u  %s  %u  %u  %u\n",(*p).r_id,p->r_name,p->r_singletrain,p->r_s_start_id,p);
        }
    }

    printp("更改后的进路列表\n");
    for(i=0;i<14;i++){
        printp("%u  %s  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u  %u\n",g_route[i].r_id,g_route[i].r_name,g_route[i].r_fsm,g_route[i].r_singletrain,g_route[i].r_triggertype,g_route[i].r_direction_1,g_route[i].r_direction_2,
            g_route[i].r_s_start_id,g_route[i].r_s_end_id,g_route[i].r_w_list,g_route[i].r_s_anti_list,g_route[i].r_t_list,g_route[i].r_other_list,g_route[i].r_t_proach_list,g_route[i].r_t_proach_dealy,
            g_route[i].r_t_auto_list_1,g_route[i].r_t_auto_list_2,g_route[i].r_t_protect,g_route[i].r_t_protect_track,g_route[i].r_t_protect_dealy,g_route[i].r_t_protect_unlock,g_route[i].r_up_next,g_route[i].r_down_next);
    }

    return 0;
}
